<!DOCTYPE html>
<html lang="en">

<head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <meta charset="utf-8">
    <title>Something</title>
    <meta name="generator" content="Bootply" />
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" href="css/navbar.css">
    <link rel="stylesheet" type="text/css" href="css/shop.css">
    <link rel="stylesheet" type="text/css" href="css/main.css">
    <link rel="stylesheet" type="text/css" href="css/blog.css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
    <script src="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>
    <!--script type="text/javascript" src='js/navbar.js'></script-->
</head>
<style type="text/css">
.anibox {
    box-sizing: border-box;
    border: 1px dotted #f00;
    /*animation: EDITABLE 2s infinite;*/
}

@-webkit-keyframes EDITABLE {
    0% {
        /*   border-left: 1px dotted #f00;*/
        border: 2px dotted #f00;
    }
    50% {
        border: 2px solid #f00;
    }
    100% {
        /*border-left: 1px solid #f00;*/
        /*border: 1px dotted #333;*/
    }
}

@-moz-keyframes EDITABLE {
    0% {
        /*   border-left: 1px dotted #f00;*/
        border: 2px dotted #f00;
    }
    50% {
        border: 2px solid #f00;
    }
    100% {
        /*border-left: 1px solid #f00;*/
        /*border: 1px dotted #333;*/
    }
}

@-o-keyframes EDITABLE {
    0% {
        /*   border-left: 1px dotted #f00;*/
        border: 2px dotted #f00;
    }
    50% {
        border: 2px solid #f00;
    }
    100% {
        /*border-left: 1px solid #f00;*/
        /*border: 1px dotted #333;*/
    }
}

@keyframes EDITABLE {
    0% {
        /*   border-left: 1px dotted #f00;*/
        border: 2px dotted #f00;
    }
    50% {
        border: 2px solid #f00;
    }
    100% {
        /*border-left: 1px solid #f00;*/
        /*border: 1px dotted #333;*/
    }
}
</style>

<body>
    <h1 class="text-center"> Test Bed</h1>
    <div class="container-fluid">
        <button type="button" class="btn btn-default go" id='_edit'><i class="fa fa-pencil-square-o"> </i> Edit</button>
        <div class="col-md-12 blog-excerpt" style="background-color : #fff; height: 100%">
            <li class="post clearfix" id=1 style="postion:relative">
                <div class="block clearfix">
                    <div class="col-md-10">
                        <div class="editarea">
                            <span class="post-title"> Lorem ipsum dolor sit amet, consectetur adipiscing elit. Integer sodales orci nec volutpat semper. Nulla a gravida ligula, a commodo lectus. Phasellus lacinia, eros sit amet rutrum accumsan, risus magna ornare metus, id elementum ipsum eros at elit. Mauris venenatis dui quis erat tincidunt, in ornare lectus blandit</span>
                            <div class="timestamp">
                                2015-09-01
                            </div>
                            <div>
                                <span class="excerpt desc">
                            Lorem ipsum dolor sit amet, consectetur adipiscing elit. Integer sodales orci nec volutpat semper. Nulla a gravida ligula, a commodo lectus. Phasellus lacinia, eros sit amet rutrum accumsan, risus magna ornare metus, id elementum ipsum eros at elit. Mauris venenatis dui quis erat tincidunt, in ornare lectus blandit. Quisque non tellus et mauris ultricies consectetur vel sit amet nibh. Donec facilisis velit nec dui ullamcorper feugiat. Sed arcu velit, fringilla a risus et, aliquam consectetur massa. Aliquam consectetur ut elit vel ullamcorper
                        	</span>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-2 col-lg-2">
                        <img src="img/Products/product3.jpg" class="img-responsive center-block">
                    </div>
                </div>
            </li>
        </div>
    </div>
</body>
<script type="text/javascript">
var button = document.querySelector('#_edit');
button.addEventListener('click', function(event) {
    buttonChageState(event, this);
}, false);

function buttonChageState(event, target) {
    var el = document.querySelector('.blog-excerpt');
    var icon = target.querySelector('i');
    if (this.buttonState == 0 || typeof(this.buttonState) == 'undefined') {
        // console.log('this.buttonState:', this.buttonState);
        target.innerText = null;
        var i_c = document.createElement('i');
        i_c.classList.add("fa");
        i_c.classList.add("fa-ban");
        target.appendChild(i_c);
        target.innerHTML += " Cancel";
        target.style.color = "#f00";
        changeContentEditable(true, el);
        this.buttonState = 1;
    } else if (this.buttonState == 1) {
        // console.log('this.buttonState:', this.buttonState);
        target.innerText = null;
        var i_c = document.createElement('i');
        i_c.classList.add("fa");
        i_c.classList.add("fa-pencil-square-o");
        target.appendChild(i_c);
        target.innerHTML += " Edit";
        target.style.color = '#333';
        changeContentEditable(false, el);
        this.buttonState = 0;
    }
}

function changeContentEditable(state, el) {
    var title = el.querySelector('.post-title');
    var excerpt = el.querySelector('.excerpt');
    title.setAttribute('contentEditable', state);
    excerpt.setAttribute('contentEditable', state);
    if (state == true) {
        // title.setAttribute('tabindex',0);
        // title.classList.add('anibox');
        // excerpt.classList.add('anibox');
        el.querySelector('.editarea').classList.add('anibox');
        el.querySelector('.editarea').focus();
        placeCaretAtEnd(title);
    } else {
        el.querySelector('.editarea').classList.remove('anibox');
    }

    function placeCaretAtEnd(el) {
        el.focus();
        if (typeof window.getSelection != "undefined" && typeof document.createRange != "undefined") {
            var range = document.createRange();
            range.selectNodeContents(el);
            range.collapse(false);
            var sel = window.getSelection();
            sel.removeAllRanges();
            sel.addRange(range);
        } else if (typeof document.body.createTextRange != "undefined") {
            var textRange = document.body.createTextRange();
            textRange.moveToElementText(el);
            textRange.collapse(false);
            textRange.select();
        }
    }
}
</script>

</html>
